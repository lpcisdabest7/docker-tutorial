# üì¶ Docker & Docker Compose v·ªõi Node.js

## 1. Docker l√† g√¨?
Docker l√† n·ªÅn t·∫£ng gi√∫p ƒë√≥ng g√≥i ·ª©ng d·ª•ng + m√¥i tr∆∞·ªùng v√†o container:

- **Container** = g√≥i ƒë·ªôc l·∫≠p, di ƒë·ªông
- **Ch·∫°y m·ªçi n∆°i** c√≥ c√†i Docker
- **ƒê·∫£m b·∫£o m√¥i tr∆∞·ªùng gi·ªëng nhau**

## 2. C√°c kh√°i ni·ªám c∆° b·∫£n

### **Image**
- **Template** ƒë·ªÉ t·∫°o container
- ƒê∆∞·ª£c **build t·ª´ Dockerfile**
- Ch·ª©a **m·ªçi th·ª©** ƒë·ªÉ ch·∫°y ·ª©ng d·ª•ng

### **Container**
- **Instance** c·ªßa image ƒëang ch·∫°y
- **ƒê·ªôc l·∫≠p** v·ªõi c√°c container kh√°c
- C√≥ th·ªÉ **start/stop/delete**

### **Dockerfile**
```dockerfile
# Base image 
FROM node:20

# Th∆∞ m·ª•c l√†m vi·ªác
WORKDIR /app

# Copy files
COPY package*.json ./
COPY . .

# C√†i dependencies
RUN npm install

# Port 
EXPOSE 3000

# L·ªánh ch·∫°y
CMD ["npm", "start"]
```

## 3. Docker Compose l√† g√¨?
Tool ƒë·ªÉ **ch·∫°y nhi·ªÅu container c√πng l√∫c**:
- **ƒê·ªãnh nghƒ©a** b·∫±ng file YAML
- **Qu·∫£n l√Ω dependencies** gi·ªØa services
- **Chia s·∫ª network/volume**

### **V√≠ d·ª• `docker-compose.yml`**
```yaml
version: '3'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    depends_on:
      - mongodb
  
  mongodb:
    image: mongo
    ports: 
      - "27017:27017"
```

## 4. Th·ª±c h√†nh

### **B∆∞·ªõc 1: Setup project**
```bash
mkdir docker-tutorial
cd docker-tutorial
npm init -y
npm i express
``` 

### **B∆∞·ªõc 2: Code `app.js`**
```javascript
const express = require('express');
const app = express();

app.get('/', (req, res) => {
  res.send('Hello Docker!');
});

app.listen(3000);
```

### **B∆∞·ªõc 3: Build & Run**
```bash
# Build image
docker build -t myapp .

# Run container
docker run -p 3000:3000 myapp

# Run v·ªõi docker-compose 
docker-compose up
```

## 5. L·ªánh th∆∞·ªùng d√πng

### **Docker**
```bash
# List containers
docker ps

# Stop container 
docker stop <id>

# Xem logs
docker logs <id>

# X√≥a container
docker rm <id>

# List images 
docker images
```

### **Docker Compose**
```bash
# Start
docker-compose up

# Start background
docker-compose up -d

# Stop
docker-compose down

# Rebuild
docker-compose up --build
```

## 6. Debug & Troubleshoot

### **Xem logs**
```bash
# Follow logs
docker-compose logs -f

# Log container c·ª• th·ªÉ
docker logs <container_id>
```

### **Truy c·∫≠p container**
```bash
# Interactive shell
docker exec -it <container_id> bash

# Ki·ªÉm tra process
docker top <container_id>
```

## 7. Best Practices

### **Security**
- Kh√¥ng ch·∫°y container v·ªõi **root**
- Scan **image vulnerabilities**
- D√πng **official images**

### **Performance**
- **T·ªëi ∆∞u cache layers**
- **Multi-stage builds**
- **Minimal base images**

## 8. Demo project: Todo API

### **Project structure**
```
todo-api/
  ‚îú‚îÄ‚îÄ src/
  ‚îÇ   ‚îî‚îÄ‚îÄ app.js
  ‚îú‚îÄ‚îÄ Dockerfile
  ‚îú‚îÄ‚îÄ docker-compose.yml
  ‚îî‚îÄ‚îÄ package.json
```

### **Docker Compose setup**
```yaml
version: '3'

services:
  api:
    build: .
    ports: 
      - "3000:3000"
    volumes:
      - .:/app
    depends_on:
      - mongo

  mongo:
    image: mongo
    ports:
      - "27017:27017"
    volumes:
      - mongodata:/data/db

volumes:
  mongodata:
```

### **Ch·∫°y project**
```bash
# Build & start
docker-compose up --build

# Check logs
docker-compose logs api

# Stop all
docker-compose down
```